<% if notice %>
<p id="notice"><%= notice %></p>
<% end %>


<h1><%= t('.title_html')%></h1>
<div id="entries">
	<% @products.each do |product| %>
		<div class="entry" >
			<%= image_tag(product.image_url) %>
			<h3><%= product.title %></h3>
			<%= truncate(strip_tags(product.description), :length => 300) %>
			<div class="price_line">
				<span class="price"><%= number_to_currency(product.price) %></span>
				Heat:
				<span class="heat" id="<%= product.id %>"><%= product.heat%></span>
				<%= periodically_call_remote(:update => { :success => product.id }, 
											 :url => { :action => 'get_heat', :product_id => product.id }, 
											 :frequency => 30) %>
				<%= button_to t('.add').html_safe, line_items_path(:product_id => product),:remote=>true ,:disabled =>@is_user%>
				<%= button_to 'collect',{:controller=> 'customers',:action=> 'collect',:product_id => product.id},:disabled =>@is_user%>
			</div>
		</div>
	<% end %>
</div>
<div id="recommend">
	<% rank = 1 %>
	<% @topfive.each do |product| %>
		<dl>
    		<dt><%= image_tag(product.image_url) %></dt>
    		<dd>
    			<strong><%= rank%></strong>
      			<div>
					<h4><h3><%= product.title %></h3><span class="price"><%= number_to_currency(product.price) %></span>Heat:<span class="heat" ><%= product.heat%></span></h4>
        			<p><%= truncate(strip_tags(product.description), :length => 80) %></p>
        			<%= button_to t('.add').html_safe, line_items_path(:product_id => product),:remote=>true ,:disabled =>@is_user%>
					<%= button_to 'collect',{:controller=> 'customers',:action=> 'collect',:product_id => product.id},:disabled =>@is_user%>
      			</div>
    		</dd>
  		</dl>
  	<% rank += 1%>
	<% end %>
</div>

